---
// src/pages/blog/[...slug].astro
import { type CollectionEntry, getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import { Image } from 'astro:assets';

// 1. 全記事のパスを生成する（これがないとエラーになります）
export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}
type Props = CollectionEntry<'blog'>;

// 2. 記事データを取得してレンダリング
const post = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title}>
  <main class="md:flex md:justify-center">
    <article class="prose prose-lg max-w-[750px] w-full">
        {post.data.heroImage && (
            <img src={post.data.heroImage} alt={post.data.title} class="w-full mb-6 rounded-xl shadow-lg" />
        )}
        <h1 class="title my-2 text-4xl font-bold">{post.data.title}</h1>
        <div class="text-sm text-gray-500 mb-6">
            {post.data.pubDate.toLocaleDateString('ja-JP')}
        </div>
        
        <div class="divider"></div>

        <Content />
    </article>
  </main>
</Layout>